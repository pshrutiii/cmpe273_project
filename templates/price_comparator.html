 {% extends "base.html" %}

  {% block head %}
  {{ super() }}
  <style>
    /* Always set the map height explicitly to define the size of the div
     * element that contains the map. */
    #map {
      height: 80%;
    }
    /* Optional: Makes the sample page fill the window. */
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
    }
  </style>
  {% endblock %}

  {% block mainbody %}
    {{ super() }}


<!-- Modal Structure -->
  <div id="add-tag-s" class="modal">
    <div class="modal-content">
      <p>Add a Label</p>
      <input id="add-tag-input" type="text" name="addtag_label" placeholder="Enter label">
    </div>
    <div class="modal-footer">
      <a class=" modal-action modal-close waves-effect waves-green btn-flat" id="addtag">Add</a>
    </div>
  </div>

 <!--<div id="choose-tag-s" class="chooseModal">-->
    <!--<div class="modal-content">-->
      <!--<p>Choose a Tag</p>-->
      <!--<input id="choose-tag-input" type="text" name="addtag_label" placeholder="Enter label">-->
    <!--</div>-->
    <!--<div class="modal-footer">-->
      <!--&lt;!&ndash;<a class=" modal-action modal-close waves-effect waves-green btn-flat" id="addtag2">Add</a>&ndash;&gt;-->
    <!--</div>-->
  <!--</div>-->

    <div class="row" style="height:100%; width=100%">
      <div class="col s12 m3 l3">
        <div class="input-field col s12">
          <input id="origin-input" name="addtag_addr" type="text" placeholder="Enter an origin location">
            <a class="btn-star tooltipped" data-position="right"  data-tooltip="Save" href="#add-tag-s">
                <i class="material-icons">star_rate</i>
            </a>
          <label for="autocomplete-input">Source</label>

        </div>
        <div class="input-field col s12">
          <input id="destination-input" type="text" placeholder="Enter a destination location">
            <a class="btn-star tooltipped" data-position="right" data-tooltip="Save" href="#add-tag-d">
                <i class="material-icons">star_rate</i>
            </a>
          <label for="autocomplete-input">Destination</label>
        </div>
        <div class="input-field col s12" id="waypoint-holder-1" style="display:none">
          <input id="waypoint-input-1" type="text" placeholder="Enter first waypoint">
            <a class="btn-star tooltipped" data-position="right" data-tooltip="Save" href="#add-tag-w1">
                <i class="material-icons">star_rate</i>
            </a>

          <label for="autocomplete-input">Waypoint 1</label>
        </div>
        <div class="input-field col s12" id="waypoint-holder-2" style="display:none">
          <input id="waypoint-input-2" type="text" placeholder="Enter second waypoint">
            <a class="btn-star tooltipped" data-position="right" data-tooltip="Save" href="#add-tag-w2">
                <i class="material-icons">star_rate</i>
            </a>
          <label for="autocomplete-input">Waypoint 2</label>
        </div>
        <div class="input-field col s12" id="waypoint-holder-3" style="display:none">
          <input id="waypoint-input-3" type="text" placeholder="Enter third waypoint">
            <a class="btn-star tooltipped" data-position="right" data-tooltip="Save" href="#add-tag-w3">
                <i class="material-icons">star_rate</i>
            </a>
          <label for="autocomplete-input">Waypoint 3</label>
        </div>
        <div class="input-field col s12" id="addwaypoint_holder">
          <a class="btn-floating btn waves-effect waves-light red tooltipped"
             data-position="right" data-tooltip="Add Another Stop" onclick="addWayPoint();">
            <i class="material-icons">add</i>
          </a>
        </div>
        <div class="input-field col s12">
          <a class="waves-effect waves-light btn" id="compare_prices_button" type="submit">Compare Prices</a>
        </div>
      </div>

      <div class="col s12 m6 l6" style="height:100%; width:50%;" id="map_holder">
        <div id="map"></div>
      </div>      

      <div class="col s12 m3 l3" id="result_holder"><!-- style="display:none"> -->
      </div>  
      
    </div>
    {% endblock %} <!-- endof mainbody block -->

    {% block javascript %}
    {{ super() }}
      <script type="text/javascript" src="../static/js/main_page.js"></script>
      <script src="https://maps.googleapis.com/maps/api/js?key={{ maps_key }}&libraries=places&callback=initMap"
        async defer></script>
<script>
    $SCRIPT_ROOT = {{ request.script_root|tojson|safe }};
    $('.btn-star').click(function (){

        if($('#origin-input').val().length == 0){
            <!--$('.chooseModal').modal();-->
            var data = {{row|safe}};
            var keys = Object.keys(data);
            var values = Object.values(data);
            <!--console.log(keys);-->

            for(var i = 0; i < keys.length; i++){
              $('<button>')
                  .attr('id', keys[i])
                  .text(keys[i])
                  .appendTo('.chooseModal .modal-content');
            }
        }else{
            $('.modal').modal();
             $(function() {
                $('#addtag').bind('click', function() {
                  $.getJSON($SCRIPT_ROOT + '/addtag', {
                    a: $('input[name="addtag_addr"]').val(),
                    l: $('input[name="addtag_label"]').val()
                  }, function(data) {
                    alert(data.result);
                  });
                  return false;
                });
              });
        }
        if($('#destination-input').val().length != 0){
            var b = $('#destination-input').val();
            //alert('Addr= ' + b + " : Label = " + $('#destination-tag #destination-label-input').val());
        }
        if($('#waypoint-input-1').val().length != 0){
            var c = $('#waypoint-input-1').val();
            var a = $('#origin-input').val();
             var l = $('#origin-tag #origin-label-input').val();
            //alert('Addr= ' + c + " : Label = " + $('#waypoint-1-tag #waypoint-1-label-input').val());
        }
        if($('#waypoint-input-2').val().length != 0){
            var d = $('#waypoint-input-2').val();
            //alert('Addr= ' + d + " : Label = " + $('#waypoint-2-tag #waypoint-2-label-input').val());
        }
        if($('#waypoint-input-3').val().length != 0){
            var e = $('#waypoint-input-3').val();
            //alert('Addr= ' + e + " : Label = " + $('#waypoint-3-tag #waypoint-3-label-input').val());
        }

    });
</script>
{% endblock %} <!-- End of javascript block -->
